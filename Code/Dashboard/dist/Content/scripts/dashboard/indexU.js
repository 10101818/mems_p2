webpackJsonp([4],{QWM4:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("P9l9"),n=a("b7ct"),s=a.n(n),r=a("ifQC"),o=a("F+jZ"),c=a("3Jf1"),l=a("Wd67"),d={components:{EventList:c.a,KpiList:l.a},data:function(){return{overview:"",chart1:{data:[],startIndex:1},totalIncome:0,totalExpense:0,totalIncomeLast:0,totalExpenseLast:0,chart3:{data:[],interval:null,activeIndex:0,timing:null},list3:[]}},computed:{},created:function(){this.getCurrUserVue(),this.getqueryOverview(),this.getRequestToday(),this.getIncome(),this.$nextTick(function(){}),this.autoSelectchart3()},methods:{getCurrUserVue:function(){roleID<0?window.location.href=BASE_URL+"/Home/Login":1==roleID?this.$router.push("indexSA"):2==roleID&&this.$router.push("indexA")},getqueryOverview:function(){var t=this;Object(i.h)().then(function(e){t.overview=e.Data})},getRequestToday:function(){var t=this;Object(i.j)().then(function(e){for(var a=e.Data,i=[],n=0;n<a.length;n++){var s=i.findIndex(function(t){return t.name==a[n].DepartmentName});-1==s?i.push({name:a[n].DepartmentName,count:1,list:[{name:" 主题："+a[n].SubjectName+" 设备编号："+a[n].EquipmentOID+" 科室："+a[n].DepartmentName,status:99!=a[n].Status.ID,statusDesc:a[n].Status.Name}]}):(i[s].count++,i[s].list.push({name:" 主题："+a[n].SubjectName+" 设备编号："+a[n].EquipmentOID+" 科室："+a[n].DepartmentName,status:99!=a[n].Status.ID,statusDesc:a[n].Status.Name}))}if(t.chart3.data=i,!a.length){var r=[];r.push({name:"暂无报修",count:1,list:[{name:"暂无报修",status:!0,statusDesc:"正常"}]}),t.chart3.data=r}t.renderChart3()})},getIncome:function(){var t=this;Object(i.a)().then(function(e){for(var a=0,i=0,n=0,s=0,r=e.Data,o=[],c=0;c<r.length;c++){a+=Number(r[c].Incomes),n+=Number(r[c].LastIncomes),i+=Number(r[c].Expenses),s+=Number(r[c].LastExpenses);var l={id:r[c].Department.ID,name:r[c].Department.Name,"收入":Number(r[c].Incomes/1e4),"支出":Number(r[c].Expenses/1e4),"设备数量":r[c].EquipmentCount,"设备价值":Number(r[c].EquipmentAmount/1e4),"服务人次":r[c].ServiceCount};o.push(l)}t.chart1.data=o,t.totalIncome=a,t.totalExpense=i,t.totalIncomeLast=n,t.totalExpenseLast=s,t.renderChart1()})},renderChart1:function(){var t=this,e=new r.DataSet.DataView;e.source(this.chart1.data).transform({type:"map",callback:function(t){return t["支出"]*=-1,t}}).transform({type:"fold",fields:["收入","支出"],key:"opinion",value:"value",retains:["name"]});var a={"收入":"#86C7E6","支出":"#1B85E7"},i=new s.a.Chart({container:"chart1",forceFit:t.chart1.data.length<=20,height:document.querySelector("#chart1").clientHeight,width:48*t.chart1.data.length,padding:[Object(o.b)(1.6),0,0,0]});i.source(e),i.axis(!1),this.chart1.data.forEach(function(t,e){t["支出"]>t["收入"]&&i.guide().regionFilter({top:!0,start:[e-.25,-t["收入"]],end:[e+.25,-t["支出"]],color:"#E2340D"})}),i.tooltip({inPlot:!0,useHtml:!0,htmlContent:function(e,a){var i={};return t.chart1.data.forEach(function(t){t.name===e&&(i=t)}),'<div class="g2-tooltip">\n                    <div class="g2-tooltip-title">'+e+'</div>\n                    <ul class="g2-tooltip-list">\n                      <li class="g2-tooltip-li">设备数量：'+t.numberComma(i.设备数量)+'</li>\n                      <li class="g2-tooltip-li">设备价值：'+t.numberComma(Math.floor(Number(i.设备价值)))+'万</li>\n                      <li class="g2-tooltip-li">服务人次：'+t.numberComma(i.服务人次)+'</li>\n                      <li class="g2-tooltip-li">收入：'+t.numberComma(Math.floor(Number(i.收入)))+'万</li>\n                      <li class="g2-tooltip-li">支出：'+t.numberComma(Math.floor(Number(i.支出)))+"万</li>\n                    </ul>\n                  </div>"}}),i.coord(),i.intervalStack().position("name*value").color("opinion",function(t){return a[t]}),i.on("click",function(e){var a=i.getSnapRecords({x:e.x,y:e.y})[0]._origin.name,n=t.chart1.data.find(function(t){return t.name==a}).id;t.$router.push({path:"/radar",query:{id:n}})}),i.render()},renderChart3:function(){var t=this,e=0;this.chart3.data.forEach(function(t){t.count>0&&(e+=t.count)}),"暂无报修"==this.chart3.data[0].name&&(e=0);var a=new s.a.Chart({container:"chart3",forceFit:!0,padding:0,height:document.querySelector("#chart3").clientHeight});a.source(this.chart3.data,{}),a.coord("theta",{radius:.75,innerRadius:.7}),a.tooltip({showTitle:!1,"g2-tooltip":{"background-color":"rgba(0, 0, 0, 0.7)",color:"#ddd"},itemTpl:'<li style="font-size: .4rem;">{name}<br/><br/><span style="font-size:.36rem;">参报数量：'+("暂无报修"==this.chart3.data[0].name?"0":"{value}")+"</span></li>"}),a.guide().html({position:["50%","50%"],html:'<div class="total-repair" style="font-size: .4rem;text-align: center;width: 10em;cursor: pointer;">\n                  <span style="font-size:.8rem;font-weight: bold;">'+e+'</span>件\n                  <div style="margin-top: .25rem">今日总报修</div>\n                </div>',alignX:"middle",alignY:"middle"}),a.legend(!1),this.chart3.interval=a.intervalStack().position("count").style({cursor:"pointer"}).color("name*count",function(t,e){if(0===e[1]-e[0])return"#eeeeee"}).tooltip("name*count",function(t,e){return{name:t,value:e,title:"参报数量："}}),a.render(),this.addEvent(!0),this.chart3.interval.setSelected(this.chart3.data[this.chart3.activeIndex]),this.getchart3List(this.chart3.activeIndex),a.on("interval:click",function(e){var a=e.data;if(a){var i=a._origin.name;t.chart3.data.forEach(function(e,a){e.name===i&&(t.chart3.activeIndex=a,t.getchart3List(t.chart3.activeIndex),clearInterval(t.chart3.timing),t.autoSelectchart3())})}})},autoSelectchart3:function(){var t=this;this.chart3.timing=setInterval(function(){t.chart3.activeIndex++,t.chart3.activeIndex>t.chart3.data.length-1&&(t.chart3.activeIndex=0),t.chart3.interval.setSelected(t.chart3.data[t.chart3.activeIndex]),t.getchart3List(t.chart3.activeIndex)},3e4)},getchart3List:function(t){this.list3=null==this.chart3.data[t]?[]:this.chart3.data[t].list,null!=document.querySelector(".list-box3")&&document.querySelector(".list-box3").scrollTo(0,0)},numberComma:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return(t=String(t).split("."))[0]=t[0].replace(new RegExp("(\\d)(?=(\\d{"+e+"})+$)","ig"),"$1,"),t.join(".")},clickEvent:function(){window.open("","_self")},addEvent:function(t){var e=document.querySelector(".total-repair");e&&(t?e.addEventListener("click",this.clickEvent):e.document.querySelector(".total-repair").removeEventListener("click",this.clickEvent))}},beforeDestroy:function(){this.addEvent(!1)}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"content"},[a("div",{staticClass:"top"},[a("div",{staticClass:"left box box1"},[a("div",{staticClass:"top-list-box"},[a("div",{staticClass:"item"},[a("div",{staticClass:" center-center value"},[t._v(t._s(null==t.overview.EquipmentCount?"Loading":t.numberComma(t.overview.EquipmentCount)))]),t._v(" "),a("div",{staticClass:" center-center text"},[t._v("设备数量（台）")])]),t._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:" center-center value"},[t._v(t._s(null==t.overview.EquipmentAmount?"Loading":t.numberComma(Math.floor(t.overview.EquipmentAmount/1e4))))]),t._v(" "),a("div",{staticClass:" center-center text"},[t._v("设备金额（万元）")])]),t._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:" center-center value"},[t._v(t._s(null==t.overview.EquipmentAmount?"Loading":(100*t.overview.DepreciationRate).toFixed(2)+"%"))]),t._v(" "),a("div",{staticClass:" center-center text"},[t._v("折旧率")])]),t._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:" center-center value"},[t._v(t._s(null==t.overview.ServiceCount?"Loading":t.numberComma(t.overview.ServiceCount)))]),t._v(" "),a("div",{staticClass:" center-center text"},[t._v("当年服务人次(人)")])])]),t._v(" "),a("div",{staticClass:"chart1-box"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("div",{staticClass:"list-box1"},[a("div",{staticClass:"list"},[a("div",{staticClass:"total"},[a("div",{staticClass:" center-center value "},[t._v(t._s(null==t.totalIncome?"Loading":t.numberComma(Math.floor(Number(t.totalIncome/1e4)))))]),t._v(" "),a("div",{staticClass:" center-center text"},[t._v("总收入（万元）")])]),t._v(" "),a("div",{class:t.totalIncome-t.totalIncomeLast>0?"status up green":"status down red"},[a("div",{staticClass:" center-center value"},[0==t.totalIncomeLast?a("span",[t._v("0.00%")]):a("span",[t._v(t._s(null==t.totalIncome?"Loading":Math.abs(Number(1*(t.totalIncome-t.totalIncomeLast)/t.totalIncomeLast*100).toFixed(2)))+"%")]),t._v(" "),a("span",{staticClass:"iconfont icon-shang"})]),t._v(" "),a("div",{staticClass:" center-center text"},[t._v("\n                                        同比去年\n                                    ")])])]),t._v(" "),a("div",{staticClass:"list"},[a("div",{staticClass:"total"},[a("div",{staticClass:" center-center value"},[t._v(t._s(null==t.totalExpense?"Loading":t.numberComma(Math.floor(Number(t.totalExpense/1e4)))))]),t._v(" "),a("div",{staticClass:" center-center text"},[t._v("总支出（万元）")])]),t._v(" "),a("div",{class:t.totalExpense-t.totalExpenseLast>0?"status up green":"status down red"},[a("div",{staticClass:" center-center value"},[0==t.totalExpenseLast?a("span",[t._v("0.00%")]):a("span",[t._v(t._s(null==t.totalExpense?"Loading":Math.abs(Number(1*(t.totalExpense-t.totalExpenseLast)/t.totalExpenseLast*100).toFixed(2)))+"%")]),t._v(" "),a("span",{staticClass:"iconfont icon-shang"})]),t._v(" "),a("div",{staticClass:" center-center text"},[t._v("\n                                        同比去年\n\t\t\t\t\t\t\t\t\t")])])])]),t._v(" "),a("div",{attrs:{id:"chart1"}})])]),t._v(" "),a("div",{staticClass:"right box box2"},[a("EventList")],1)]),t._v(" "),a("div",{staticClass:"bottom"},[a("div",{staticClass:"left box box3"},[a("div",{attrs:{id:"chart3"}}),t._v(" "),a("div",{staticClass:"list-box-container"},[a("div",{staticClass:"list-box3",style:t.chart3.data.length>0&&"暂无报修"==t.chart3.data[0].name?"display: flex;align-items: center;justify-content: center;":""},[t._l(t.list3,function(e,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:t.chart3.data.length>0&&"暂无报修"!=t.chart3.data[0].name,expression:"chart3.data.length>0 && chart3.data[0].name!='暂无报修'"}],key:i,staticClass:"list"},[a("span",{staticClass:"index"},[t._v(t._s(i+1))]),t._v(" "),a("span",{staticClass:"name elip",attrs:{title:e.name}},[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"status",class:{err:e.status}},[t._v(t._s(e.statusDesc))])])}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.chart3.data.length>0&&"暂无报修"==t.chart3.data[0].name,expression:"chart3.data.length>0 && chart3.data[0].name=='暂无报修'"}],staticClass:"repairNull"},[a("div",{staticClass:"repairText"},[t._v("暂无报修")])])],2)])]),t._v(" "),a("div",{staticClass:"right box box4"},[a("KpiList")],1)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{position:"absolute"}},[e("span",{staticStyle:{"border-left":"5px solid #86C7E6","border-right":"5px solid #86C7E6","border-bottom":"5px solid #86C7E6","border-top":"5px solid #86C7E6",display:"inline-block"}}),this._v(" 收入")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{position:"absolute",top:"1rem"}},[e("span",{staticStyle:{"border-left":"5px solid #1B85E7","border-right":"5px solid #1B85E7","border-bottom":"5px solid #1B85E7","border-top":"5px solid #1B85E7",display:"inline-block"}}),this._v(" 支出")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{position:"absolute",top:"1.5rem"}},[e("span",{staticStyle:{"border-left":"5px solid red","border-right":"5px solid red","border-bottom":"5px solid red","border-top":"5px solid red",display:"inline-block"}}),this._v(" 盈亏")])}]};var v=a("VU/8")(d,u,!1,function(t){a("pkQ2")},"data-v-9bf57f7e",null);e.default=v.exports},pkQ2:function(t,e){}});
//# sourceMappingURL=indexU.js.map